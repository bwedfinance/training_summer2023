<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.306">

  <meta name="dcterms.date" content="2023-06-27">
  <title>School Finance Equity Training, Summer 2023 - Data cleaning and processing in R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <link href="../../site_libs/countdown-0.4.0/countdown.css" rel="stylesheet">
  <script src="../../site_libs/countdown-0.4.0/countdown.js"></script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Data cleaning and processing in R</h1>

<div class="quarto-title-authors">
</div>

  <p class="date">2023-06-27</p>
</section>
<section>
<section id="review" class="title-slide slide level1 center">
<h1>Review</h1>

</section>
<section id="review-from-week-2" class="slide level2">
<h2>Review from Week 2</h2>
<p>General tips and things to keep in mind from talking with several of you:</p>
<ul>
<li>Keep all of your variable names lowercase (including dataframes!) — it helps prevent potential problems and errors.</li>
<li>In order to create a scatterplot or histogram with <code>ggplot()</code>, you need to make sure the dataframe you want to use is available in your working environment. Reminder: your working environment will be empty when you start RStudio — you’ll need to run each line of code that comes <em>before</em> your plot code in order for it to run successfully.</li>
<li>To run the code for a plot, you can execute it by clicking “Run” or hitting Command + Enter on your keybord if you have either 1) placed your cursor anywhere in the code for the plot or 2) you’ve higlighted all of the lines of code to create your plot (highlighting a single line will <em>not</em> work).</li>
</ul>
</section></section>
<section>
<section id="principles-of-tidy-data" class="title-slide slide level1 center">
<h1>Principles of tidy data</h1>

</section>
<section id="cleaning-your-data-one-of-the-most-important-and-under-appreciated-stages-of-good-data-analysis" class="slide level2">
<h2>Cleaning your data: One of the most important and under-appreciated stages of good data analysis</h2>
<div class="callout callout-none no-icon callout-style-simple">
<div class="callout-body">
<div class="callout-content">
<p><strong>“Tidy datasets are all alike, but every messy dataset is messy in its own way.” - Hadley Wickham</strong></p>
</div>
</div>
</div>
<ul>
<li><p>Education finance data, like most other data, rarely come to us in a format that is plug-and-play ready for analysis.</p></li>
<li><p>A high-quality analysis of your state’s school finance system must start with gathering and cleaning relevant data.</p></li>
<li><p>This starts with ensuring that each dataframe of raw data you read into R goes through a process of becoming “tidy” — once you have tidy data, merging and visualizing data becomes much easier.</p></li>
<li><p>The process of tidying your data is also helpful for identifying anomalies or outliers in your raw data files.</p></li>
</ul>
</section>
<section id="the-principles-of-tidy-data-provide-a-helpful-vision-of-what-good-clean-data-should-look-like" class="slide level2 smaller">
<h2>The principles of “tidy data” provide a helpful vision of what good, clean data should look like</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Tidy data follows three rules:</p>
<ol type="1">
<li>Each column is a variable</li>
<li>Each row is an observation</li>
<li>Each cell is a value</li>
</ol>
</div><div class="column" style="width:50%;">
<p>Building tidy datasets will:</p>
<p>• Bring consistency to your data across scripts/projects</p>
<p>• Make it easier to work with functions in the `tidyverse`, which is built to work will with “tidy” data</p>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://d33wubrfki0l68.cloudfront.net/6f1ddb544fc5c69a2478e444ab8112fb0eea23f8/08547/images/r4ds/tidy-1.png"></p>
</figure>
</div>

<aside><div>
<p>Source: <a href="https://r4ds.had.co.nz/tidy-data.html">R for Data Science</a></p>
</div></aside></section>
<section id="it-takes-a-bit-of-work-to-make-data-tidy-including-the-use-of-functions-to-reshape-your-data" class="slide level2">
<h2>It takes a bit of work to make data tidy, including the use of functions to reshape your data</h2>
<p>Datasets can violate the principles of tidy data in several ways:</p>
<ul>
<li><strong>Variables can be embedded across columns</strong>: An common example is when multiple columns represent data from different years. In this case, a variable (year) is actually represented by column names instead of being captured in its own “year” column.</li>
<li><strong>Solution</strong>: Pivot your data longer!</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 4
  state sy20_rev sy21_rev sy22_rev
  &lt;chr&gt;    &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
1 AL     2023902  2304983  3930833
2 AK      230993   233466   283948
3 AZ      203492   390282   409828</code></pre>
</div>
</div>
</section>
<section id="it-takes-a-bit-of-work-to-make-data-tidy-including-the-use-of-functions-to-reshape-your-data-cont." class="slide level2">
<h2>It takes a bit of work to make data tidy, including the use of functions to reshape your data, cont.</h2>
<ul>
<li><strong>A single observation may be spread across multiple rows</strong>: This can happen when one column includes multiple variable types within it. And example would be if a dataframe had a “data_type” column that included entries like “n_tested” and “pct_prof”.</li>
<li><strong>Solution</strong>: Pivot your table wider!</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 3
  sch_name         data_type  value
  &lt;chr&gt;            &lt;chr&gt;      &lt;dbl&gt;
1 Alpha Elementary n_tested  230   
2 Alpha Elementary pct_prof    0.53
3 Bravo Middle     n_tested  492   
4 Bravo Middle     pct_prof    0.34
5 Charlie High     n_tested  434   
6 Charlie High     pct_prof    0.43</code></pre>
</div>
</div>
</section>
<section id="pivot_longer-is-useful-when-a-variable-is-embedded-across-several-column-names" class="slide level2">
<h2><code>pivot_longer()</code> is useful when a variable is embedded across several column names</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://epirhandbook.com/en/images/pivoting/pivot_longer_new.png"></p>
</figure>
</div>

<aside><div>
<p>Source: <a href="https://epirhandbook.com/en/pivoting-data.html#wide-to-long">The Epidemiologist R Handbook</a></p>
</div></aside></section>
<section id="live-coding-example-using-pivot_longer" class="slide level2 scrollable">
<h2>Live coding example: Using <code>pivot_longer()</code></h2>
<p>Key arguments of the <code>pivot_longer()</code> function:</p>
<ul>
<li><code>cols</code>: The names of the columns to pivot using <a href="https://tidyr.tidyverse.org/reference/tidyr_tidy_select.html"><code>tidy-select</code></a></li>
<li><code>names_to</code>: The name for the new character column</li>
<li><code>values_to</code>: The name for the new values column</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># PIVOT LONGER EXAMPLE</span></span>
<span id="cb3-2"><a href="#cb3-2"></a></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co"># load ----</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># read in data for analysis</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>usa_2008_2021 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"slides/week_04/data/usa_2008_2021.csv"</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Clean and analyze data ----</span></span>
<span id="cb3-10"><a href="#cb3-10"></a></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co"># Per-Pupil Education Streams </span></span>
<span id="cb3-12"><a href="#cb3-12"></a>usa_all_education_streams_long <span class="ot">&lt;-</span> usa_2008_2021 <span class="sc">|&gt;</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>  <span class="co"># Filter out years that we don't need in our analysis </span></span>
<span id="cb3-14"><a href="#cb3-14"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;</span> <span class="dv">2007</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>  <span class="co"># Select variables that we want to use to pivot our data longer </span></span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="fu">select</span>(year, usa_state_pp, usa_local_pp, usa_federal_pp) <span class="sc">|&gt;</span> </span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> usa_state_pp<span class="sc">:</span>usa_federal_pp, <span class="co"># These are the columns we want to pivot </span></span>
<span id="cb3-18"><a href="#cb3-18"></a>               <span class="at">names_to =</span> <span class="st">"revenue_source"</span>, <span class="co"># The name for the new character column</span></span>
<span id="cb3-19"><a href="#cb3-19"></a>               <span class="at">values_to =</span> <span class="st">"revenue"</span>) <span class="sc">|&gt;</span> <span class="co"># The name for the new values </span></span>
<span id="cb3-20"><a href="#cb3-20"></a>  <span class="co"># Convert the column created with "names_to" to a nicely-labeled factor</span></span>
<span id="cb3-21"><a href="#cb3-21"></a>  <span class="fu">mutate</span>(<span class="at">revenue_source =</span> <span class="fu">factor</span>(revenue_source,</span>
<span id="cb3-22"><a href="#cb3-22"></a>                                 <span class="co"># specify the order of values in this variable</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>                                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"usa_state_pp"</span>,</span>
<span id="cb3-24"><a href="#cb3-24"></a>                                            <span class="st">"usa_local_pp"</span>, </span>
<span id="cb3-25"><a href="#cb3-25"></a>                                            <span class="st">"usa_federal_pp"</span>),</span>
<span id="cb3-26"><a href="#cb3-26"></a>                                 <span class="co"># give the variable nice labels</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>                                 <span class="co"># these need to be the same order as the levels you set!</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>                                 <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Local"</span>, <span class="st">"State"</span>, <span class="st">"Federal"</span>))) <span class="sc">|&gt;</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>  <span class="co"># create a new column that indicates all of this data is national</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="fu">mutate</span>(<span class="at">state =</span> <span class="st">"United States"</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-31"><a href="#cb3-31"></a>  <span class="co"># create a nicely-formatted year column</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>  <span class="fu">mutate</span>(<span class="at">year_1 =</span> year <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb3-33"><a href="#cb3-33"></a>         <span class="at">year_2 =</span> <span class="fu">str_sub</span>(<span class="fu">as.character</span>(year), <span class="at">start =</span> <span class="dv">3</span>),</span>
<span id="cb3-34"><a href="#cb3-34"></a>         <span class="at">year =</span> <span class="fu">paste0</span>(year_1, <span class="st">"-"</span>, year_2)) <span class="sc">|&gt;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>  <span class="co"># remove intermediate year columns |&gt; </span></span>
<span id="cb3-36"><a href="#cb3-36"></a>  <span class="fu">select</span>(<span class="sc">-</span>year_1, <span class="sc">-</span>year_2) <span class="sc">|&gt;</span> </span>
<span id="cb3-37"><a href="#cb3-37"></a>  <span class="co"># reorder our columns so that state and year are first</span></span>
<span id="cb3-38"><a href="#cb3-38"></a>  <span class="fu">select</span>(state, year, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="if-your-data-includes-data-from-a-single-observation-spread-across-multiple-rows-use-pivot_wider" class="slide level2">
<h2>If your data includes data from a single observation spread across multiple rows, use <code>pivot_wider()</code></h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://bcheggeseth.github.io/112_fall_2022/images/pivot_wider.png"></p>
</figure>
</div>

<aside><div>
<p>Source: <a href="https://bcheggeseth.github.io/112_fall_2022/reshaping-data.html#wider">Macalester College COMP/STAT 112: Introduction to Data Science</a></p>
</div></aside></section>
<section id="live-coding-example-using-pivot_wider" class="slide level2">
<h2>Live coding example: Using <code>pivot_wider()</code></h2>
<p>Breaking down the code:</p>
<ul>
<li><strong>names_from:</strong> The column with values that include multiple variables; will be pivoted into column names.</li>
<li><strong>values_from:</strong> The column with values will be used as cell values after pivoting.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># PIVOT WIDER EXAMPLE</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>dist_sped_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/dist_sped_raw.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># clean special ed data ---------</span></span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a>dist_sped <span class="ot">&lt;-</span> dist_sped_raw <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> cat_number, <span class="co"># The column where we are using the value as a column name </span></span>
<span id="cb4-8"><a href="#cb4-8"></a>              <span class="at">values_from =</span> enroll) <span class="co"># The column whose values will be used as the values in the cell </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="techniques-to-clean-messy-data" class="title-slide slide level1 center">
<h1>Techniques to clean messy data</h1>

</section>
<section id="cleaning-data-can-be-challenging-but-its-easier-if-you-take-a-systematic-approach" class="slide level2 smaller">
<h2>Cleaning data can be challenging, but it’s easier if you take a systematic approach</h2>
<table>
<colgroup>
<col style="width: 11%">
<col style="width: 88%">
</colgroup>
<thead>
<tr class="header">
<th>Step</th>
<th>Goal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Data import</td>
<td>Ensure your import function is set up to read the data properly</td>
</tr>
<tr class="even">
<td>Column names</td>
<td><p>Reformat or manually create column names that are:</p>
<ul>
<li><p>lowercase</p></li>
<li><p>use underscores instead of spaces</p></li>
<li><p>do not begin with a number</p></li>
<li><p>follow a consistent format</p></li>
</ul></td>
</tr>
<tr class="odd">
<td>Mis-formatted data</td>
<td>Work with functions from base R like <code>as.numeric()</code> or from the <code>tidyverse</code> packages like <code>stringr</code> to clean the data that appear in a different format than you want.</td>
</tr>
<tr class="even">
<td>Missing data</td>
<td>Identify where in your dataset there are missing variables and/or outliers - this may be more of an iterative process as your explore your data.</td>
</tr>
</tbody>
</table>
</section>
<section id="live-coding-example-florida_clean.r" class="slide level2">
<h2>Live coding example: florida_clean.R</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># load ---------</span></span>
<span id="cb5-2"><a href="#cb5-2"></a></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="fu">library</span>(readxl)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co"># load fl revenue raw data</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>fl_tax_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/1819Tables.xlsx"</span>, </span>
<span id="cb5-10"><a href="#cb5-10"></a>                         <span class="at">sheet =</span> <span class="dv">9</span>)</span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co"># skip first row when reading data</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>fl_tax_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/1819Tables.xlsx"</span>, </span>
<span id="cb5-14"><a href="#cb5-14"></a>                         <span class="at">sheet =</span> <span class="dv">9</span>, <span class="at">skip =</span> <span class="dv">1</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co"># limit data to max of 67 rows</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>fl_tax_raw <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"data/1819Tables.xlsx"</span>, </span>
<span id="cb5-18"><a href="#cb5-18"></a>                         <span class="at">sheet =</span> <span class="dv">9</span>, <span class="at">skip =</span> <span class="dv">1</span>, <span class="at">n_max =</span> <span class="dv">67</span>)</span>
<span id="cb5-19"><a href="#cb5-19"></a></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co"># clean ---------</span></span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co"># fix column names</span></span>
<span id="cb5-23"><a href="#cb5-23"></a>fl_tax_clean <span class="ot">&lt;-</span> fl_tax_raw <span class="sc">|&gt;</span></span>
<span id="cb5-24"><a href="#cb5-24"></a>  <span class="co"># convert colnames to lowercase</span></span>
<span id="cb5-25"><a href="#cb5-25"></a>  <span class="fu">rename_with</span>(tolower) </span>
<span id="cb5-26"><a href="#cb5-26"></a></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co"># look at column names</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="fu">names</span>(fl_tax_clean)</span>
<span id="cb5-29"><a href="#cb5-29"></a></span>
<span id="cb5-30"><a href="#cb5-30"></a><span class="co"># create vector of new column names</span></span>
<span id="cb5-31"><a href="#cb5-31"></a>new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"district"</span>, </span>
<span id="cb5-32"><a href="#cb5-32"></a>               <span class="st">"operating_millage"</span>, </span>
<span id="cb5-33"><a href="#cb5-33"></a>               <span class="st">"tax_roll_fy18"</span>,</span>
<span id="cb5-34"><a href="#cb5-34"></a>               <span class="st">"operating_tax_yield"</span>, </span>
<span id="cb5-35"><a href="#cb5-35"></a>               <span class="st">"required_effort"</span>)</span>
<span id="cb5-36"><a href="#cb5-36"></a></span>
<span id="cb5-37"><a href="#cb5-37"></a><span class="co"># manually replace column names</span></span>
<span id="cb5-38"><a href="#cb5-38"></a><span class="fu">colnames</span>(fl_tax_clean) <span class="ot">&lt;-</span> new_names</span>
<span id="cb5-39"><a href="#cb5-39"></a></span>
<span id="cb5-40"><a href="#cb5-40"></a><span class="co"># look at column names now</span></span>
<span id="cb5-41"><a href="#cb5-41"></a><span class="fu">names</span>(fl_tax_clean)</span>
<span id="cb5-42"><a href="#cb5-42"></a></span>
<span id="cb5-43"><a href="#cb5-43"></a><span class="co"># look at district names</span></span>
<span id="cb5-44"><a href="#cb5-44"></a><span class="fu">glimpse</span>(fl_tax_clean<span class="sc">$</span>district)</span>
<span id="cb5-45"><a href="#cb5-45"></a></span>
<span id="cb5-46"><a href="#cb5-46"></a><span class="co"># convert district names to title case</span></span>
<span id="cb5-47"><a href="#cb5-47"></a>fl_tax_clean <span class="ot">&lt;-</span> fl_tax_clean <span class="sc">|&gt;</span> </span>
<span id="cb5-48"><a href="#cb5-48"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">str_to_title</span>(district))</span>
<span id="cb5-49"><a href="#cb5-49"></a></span>
<span id="cb5-50"><a href="#cb5-50"></a><span class="co"># look at district names now</span></span>
<span id="cb5-51"><a href="#cb5-51"></a><span class="fu">glimpse</span>(fl_tax_clean<span class="sc">$</span>district)</span>
<span id="cb5-52"><a href="#cb5-52"></a></span>
<span id="cb5-53"><a href="#cb5-53"></a><span class="co"># fix a special case - "Desoto" should be "DeSoto"</span></span>
<span id="cb5-54"><a href="#cb5-54"></a>fl_tax_clean<span class="sc">$</span>district[<span class="dv">14</span>]</span>
<span id="cb5-55"><a href="#cb5-55"></a></span>
<span id="cb5-56"><a href="#cb5-56"></a><span class="co"># replace all instances of "Desoto" with "DeSoto"</span></span>
<span id="cb5-57"><a href="#cb5-57"></a>fl_tax_clean <span class="ot">&lt;-</span> fl_tax_clean <span class="sc">|&gt;</span> </span>
<span id="cb5-58"><a href="#cb5-58"></a>  <span class="fu">mutate</span>(<span class="at">district =</span> <span class="fu">str_replace_all</span>(district, <span class="st">"Desoto"</span>, <span class="st">"DeSoto"</span>))</span>
<span id="cb5-59"><a href="#cb5-59"></a></span>
<span id="cb5-60"><a href="#cb5-60"></a><span class="co"># check that the above code worked</span></span>
<span id="cb5-61"><a href="#cb5-61"></a>fl_tax_clean<span class="sc">$</span>district[<span class="dv">14</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="joining-datasets" class="title-slide slide level1 center">
<h1>Joining datasets</h1>

</section>
<section id="your-data-will-rarely-come-to-you-in-a-single-table.-you-will-need-to-join-functions-to-merge-dataframes-together" class="slide level2">
<h2>Your data will rarely come to you in a single table. You will need to join functions to merge dataframes together</h2>
<p>To join two dataframes, they need to share a common column with a unique identifier.</p>
<p>State departments of education typically assign a unique ID number to each school district. <strong>Make sure this is available in your datasets.</strong></p>
<p>Joining datasets on a name (e.g.&nbsp;school or district) can create problems based on:</p>
<ul>
<li>Capitalization (Mcgregor v. McGregor)</li>
<li>Abbreviation (St.&nbsp;Paul v. Saint Paul)</li>
<li>Mis-spelling (it happens!)</li>
</ul>
</section>
<section id="using-left_join-to-merge-datasets-will-help-preserve-your-data" class="slide level2 smaller">
<h2>Using <code>left_join()</code> to merge datasets will help preserve your data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Once you have dataframes that share a common ID column, start with your most reliable set of data (typically student count data like ADM or enrollment) and use <code>left_join()</code> to attach additional data to that table.</p></li>
<li><p>This approach will preserve your original data, keeping the number of rows (e.g.&nbsp;districts or schools) consistent as you use <code>left_join()</code> to add data by adding more columns.</p></li>
<li><p>When a record in the “left” dataframe does not have a match in the “right” dataframe, <code>left_join()</code> will impute a value of <code>NA</code> for all such instances.</p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/join-left.png"></p>
</figure>
</div>
</div>
</div>

<aside><div>
<p>Source: <a href="https://r4ds.had.co.nz/relational-data.html#outer-join">R for Data Science</a></p>
</div></aside></section>
<section id="coding-example-how-to-use-left_join" class="slide level2">
<h2>Coding example: How to use <code>left_join()</code></h2>
<ul>
<li><strong>Example 1:</strong> The common ID columns have the same variable names (sch_id)</li>
<li><strong>Example 2:</strong> The common ID columns have different variable names. The <strong>sch_clean</strong> dataframe’s variable is sch_id, while the <strong>sch_el</strong> data frame’s variable name is school_id. The column names can be different, but the values within the cells must be the same so we can join them.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># join data ---------</span></span>
<span id="cb6-2"><a href="#cb6-2"></a></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co"># EXAMPLE 1: Join the ADM, special education, economically disadvantaged, and ELL student data</span></span>
<span id="cb6-4"><a href="#cb6-4"></a>sch_clean <span class="ot">&lt;-</span> sch_adm <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>  <span class="fu">left_join</span>(sch_ed, <span class="at">by =</span> <span class="st">"sch_id"</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>  <span class="fu">left_join</span>(sch_sped, <span class="at">by =</span> <span class="st">"sch_id"</span>) </span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># EXAMPLE 2: Join the ELL data </span></span>
<span id="cb6-9"><a href="#cb6-9"></a></span>
<span id="cb6-10"><a href="#cb6-10"></a>sch_clean <span class="ot">&lt;-</span> sch_clean <span class="sc">|&gt;</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">left_join</span>(sch_el, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"sch_id"</span> <span class="ot">=</span> <span class="st">"school_id"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="as-you-merge-dataframes-be-sure-to-use-anti_join-to-examine-missing-data" class="slide level2">
<h2>As you merge dataframes, be sure to use <code>anti_join()</code> to examine missing data</h2>
<p>Using the <code>anti_join()</code> function from the <a href="https://dplyr.tidyverse.org/index.html">dplyr</a> package in R returns all rows in one data frame that do not have matching values in another data frame. Using anti_join() allows you to explore the incongruities in your data.</p>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://d33wubrfki0l68.cloudfront.net/f29a85efd53a079cc84c14ba4ba6894e238c3759/c1408/diagrams/join-anti.png"></p>
</figure>
</div>

<aside><div>
<p>Source: <a href="https://r4ds.had.co.nz/relational-data.html#understanding-joins">R for Data Science</a></p>
</div></aside></section>
<section id="coding-example-how-to-use-anti_join" class="slide level2">
<h2>Coding example: How to use <code>anti_join()</code></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># matching tests --------</span></span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co"># only charlie county, which only has adm of 5</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>dist_no_area <span class="ot">&lt;-</span> dist_summary <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="fu">anti_join</span>(state_dist_area)</span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># check to make sure there aren't any distircts in the area df</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co"># that arent in our dist_summary df</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co"># no misses!</span></span>
<span id="cb7-10"><a href="#cb7-10"></a>area_no_dist <span class="ot">&lt;-</span> state_dist_area <span class="sc">|&gt;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a>  <span class="fu">anti_join</span>(dist_summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section id="break" class="title-slide slide level1 center">
<h1>Break</h1>
<div class="cell">
<div class="cell-output-display">
<div class="countdown" id="timer_de1fa84c" data-update-every="1" tabindex="0" style="right:0;bottom:0;font-size:1.5em;">
<div class="countdown-controls"><button class="countdown-bump-down">−</button><button class="countdown-bump-up">+</button></div>
<code class="countdown-time"><span class="countdown-digits minutes">10</span><span class="countdown-digits colon">:</span><span class="countdown-digits seconds">00</span></code>
</div>
</div>
</div>
</section>

<section>
<section id="an-example-with-tidycensus" class="title-slide slide level1 center">
<h1>An example with <code>tidycensus</code></h1>

</section>
<section id="the-tidycensus-package-can-provide-data-at-the-school-district-level-that-may-be-helpful-for-school-finance-analysis" class="slide level2">
<h2>The <code>tidycensus</code> package can provide data at the school district level that may be helpful for school finance analysis</h2>
<div class="columns">
<div class="column" style="width:60%;">
<p>The Census Bureau collects a lot of information that is reported at the school district level. This includes information on topics that are relevant to school finance, like housing.</p>
<p>The <code>tidycensus</code> R package makes it easy to access, explore, and analyze Census Bureau data.</p>
<p>Use <code>install.packages("tidycensus")</code> to download the package in RStudio.</p>
</div><div class="column" height="45%" data-fig-align="center" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://walker-data.com/tidycensus/logo.png"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="to-get-started-youll-need-to-sign-up-for-an-api-key-with-the-census-bureau" class="slide level2">
<h2>To get started, you’ll need to sign up for an API key with the Census Bureau</h2>

<img data-src="https://michaeldgarber.github.io/teach-r/images/census-api-key-landing.png" class="r-stretch quarto-figure-center"><p><a href="https://api.census.gov/data/key_signup.html">Signup for an API key here!</a></p>
</section></section>
<section>
<section id="in-class-exercise" class="title-slide slide level1 center">
<h1>In-class exercise</h1>

</section>
<section id="in-class-coding-example-clean_and_join.r-13" class="slide level2">
<h2>In-class coding example: clean_and_join.R (1/3)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># load -----------</span></span>
<span id="cb8-2"><a href="#cb8-2"></a></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>)</span>
<span id="cb8-4"><a href="#cb8-4"></a></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="fu">library</span>(edbuildr)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="fu">library</span>(tidycensus)</span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="fu">library</span>(viridis)</span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="fu">library</span>(scales)</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co"># get your own api key from https://api.census.gov/data/key_signup.html</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co"># only run this line of code once after you replace the text below</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co"># with your API key</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="fu">census_api_key</span>(<span class="st">"YOUR API KEY GOES HERE"</span>, <span class="at">install =</span> <span class="cn">TRUE</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co"># get edbuild data</span></span>
<span id="cb8-17"><a href="#cb8-17"></a>edbuild_fy19 <span class="ot">&lt;-</span> <span class="fu">masterpull</span>(<span class="at">data_type =</span> <span class="st">"geo"</span>)</span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a><span class="co"># load census variables from 2019 acs 5-year estimates</span></span>
<span id="cb8-20"><a href="#cb8-20"></a>v19 <span class="ot">&lt;-</span> <span class="fu">load_variables</span>(<span class="dv">2019</span>, <span class="st">"acs5"</span>, <span class="at">cache =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-21"><a href="#cb8-21"></a></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co"># get mortgage data for unified school districts</span></span>
<span id="cb8-23"><a href="#cb8-23"></a>mortgage_unified_raw <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B25101_001"</span>, <span class="co"># total households</span></span>
<span id="cb8-24"><a href="#cb8-24"></a>                                              <span class="st">"B25101_002"</span>, <span class="co"># total with a mortgage</span></span>
<span id="cb8-25"><a href="#cb8-25"></a>                                              <span class="st">"B25101_024"</span>), <span class="co"># total not mortgaged</span></span>
<span id="cb8-26"><a href="#cb8-26"></a>                        <span class="at">geography =</span> <span class="st">"school district (unified)"</span>,</span>
<span id="cb8-27"><a href="#cb8-27"></a>                        <span class="at">state =</span> <span class="st">"MN"</span>, </span>
<span id="cb8-28"><a href="#cb8-28"></a>                        <span class="at">year =</span> <span class="dv">2019</span>)</span>
<span id="cb8-29"><a href="#cb8-29"></a></span>
<span id="cb8-30"><a href="#cb8-30"></a><span class="co"># get mortgage data for elementary school districts</span></span>
<span id="cb8-31"><a href="#cb8-31"></a>mortgage_elementary_raw <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B25101_001"</span>, <span class="co"># total households</span></span>
<span id="cb8-32"><a href="#cb8-32"></a>                                                  <span class="st">"B25101_002"</span>, <span class="co"># total with a mortgage</span></span>
<span id="cb8-33"><a href="#cb8-33"></a>                                                  <span class="st">"B25101_024"</span>), <span class="co"># total not mortgaged</span></span>
<span id="cb8-34"><a href="#cb8-34"></a>                                    <span class="at">geography =</span> <span class="st">"school district (elementary)"</span>,</span>
<span id="cb8-35"><a href="#cb8-35"></a>                                    <span class="at">state =</span> <span class="st">"MN"</span>, </span>
<span id="cb8-36"><a href="#cb8-36"></a>                                    <span class="at">year =</span> <span class="dv">2019</span>)</span>
<span id="cb8-37"><a href="#cb8-37"></a></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="co"># get mortgage data for secondary school districts</span></span>
<span id="cb8-39"><a href="#cb8-39"></a>mortgage_secondary_raw <span class="ot">&lt;-</span> <span class="fu">get_acs</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"B25101_001"</span>, <span class="co"># total households</span></span>
<span id="cb8-40"><a href="#cb8-40"></a>                                                  <span class="st">"B25101_002"</span>, <span class="co"># total with a mortgage</span></span>
<span id="cb8-41"><a href="#cb8-41"></a>                                                  <span class="st">"B25101_024"</span>), <span class="co"># total not mortgaged</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>                                    <span class="at">geography =</span> <span class="st">"school district (secondary)"</span>,</span>
<span id="cb8-43"><a href="#cb8-43"></a>                                    <span class="at">state =</span> <span class="st">"MN"</span>, </span>
<span id="cb8-44"><a href="#cb8-44"></a>                                    <span class="at">year =</span> <span class="dv">2019</span>)</span>
<span id="cb8-45"><a href="#cb8-45"></a></span>
<span id="cb8-46"><a href="#cb8-46"></a></span>
<span id="cb8-47"><a href="#cb8-47"></a><span class="co"># clean ------------</span></span>
<span id="cb8-48"><a href="#cb8-48"></a></span>
<span id="cb8-49"><a href="#cb8-49"></a><span class="co"># clean mortgage data for unified school districts</span></span>
<span id="cb8-50"><a href="#cb8-50"></a>mortgage_pct_unified <span class="ot">&lt;-</span> mortgage_unified_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-51"><a href="#cb8-51"></a>  <span class="co"># replace vars with more descriptive names</span></span>
<span id="cb8-52"><a href="#cb8-52"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_001"</span>, <span class="st">"households"</span>),</span>
<span id="cb8-53"><a href="#cb8-53"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_002"</span>, <span class="st">"with_mortgage"</span>),</span>
<span id="cb8-54"><a href="#cb8-54"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_024"</span>, <span class="st">"no_mortgage"</span>)</span>
<span id="cb8-55"><a href="#cb8-55"></a>        ) <span class="sc">|&gt;</span>  <span class="co"># close mutate </span></span>
<span id="cb8-56"><a href="#cb8-56"></a>  <span class="co"># remove margin of error column</span></span>
<span id="cb8-57"><a href="#cb8-57"></a>  <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">|&gt;</span> </span>
<span id="cb8-58"><a href="#cb8-58"></a>  <span class="co"># pivot variable column into distinct columns</span></span>
<span id="cb8-59"><a href="#cb8-59"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb8-60"><a href="#cb8-60"></a>  <span class="co"># calculate percent of households within a school district with a mortgage</span></span>
<span id="cb8-61"><a href="#cb8-61"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_pct =</span> with_mortgage <span class="sc">/</span> households) </span>
<span id="cb8-62"><a href="#cb8-62"></a></span>
<span id="cb8-63"><a href="#cb8-63"></a><span class="co"># clean mortgage data for elementary school districts</span></span>
<span id="cb8-64"><a href="#cb8-64"></a>mortgage_pct_elementary <span class="ot">&lt;-</span> mortgage_elementary_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-65"><a href="#cb8-65"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_001"</span>, <span class="st">"households"</span>),</span>
<span id="cb8-66"><a href="#cb8-66"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_002"</span>, <span class="st">"with_mortgage"</span>),</span>
<span id="cb8-67"><a href="#cb8-67"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_024"</span>, <span class="st">"no_mortgage"</span>)</span>
<span id="cb8-68"><a href="#cb8-68"></a>  ) <span class="sc">|&gt;</span>  <span class="co"># close mutate </span></span>
<span id="cb8-69"><a href="#cb8-69"></a>  <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">|&gt;</span> </span>
<span id="cb8-70"><a href="#cb8-70"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb8-71"><a href="#cb8-71"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_pct =</span> with_mortgage <span class="sc">/</span> households)</span>
<span id="cb8-72"><a href="#cb8-72"></a></span>
<span id="cb8-73"><a href="#cb8-73"></a><span class="co"># clean mortgage data for secondary school districts</span></span>
<span id="cb8-74"><a href="#cb8-74"></a>mortgage_pct_secondary <span class="ot">&lt;-</span> mortgage_secondary_raw <span class="sc">|&gt;</span> </span>
<span id="cb8-75"><a href="#cb8-75"></a>  <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_001"</span>, <span class="st">"households"</span>),</span>
<span id="cb8-76"><a href="#cb8-76"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_002"</span>, <span class="st">"with_mortgage"</span>),</span>
<span id="cb8-77"><a href="#cb8-77"></a>         <span class="at">variable =</span> <span class="fu">str_replace_all</span>(variable, <span class="st">"B25101_024"</span>, <span class="st">"no_mortgage"</span>)</span>
<span id="cb8-78"><a href="#cb8-78"></a>  ) <span class="sc">|&gt;</span>  <span class="co"># close mutate </span></span>
<span id="cb8-79"><a href="#cb8-79"></a>  <span class="fu">select</span>(<span class="sc">-</span>moe) <span class="sc">|&gt;</span> </span>
<span id="cb8-80"><a href="#cb8-80"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> variable, <span class="at">values_from =</span> estimate) <span class="sc">|&gt;</span> </span>
<span id="cb8-81"><a href="#cb8-81"></a>  <span class="fu">mutate</span>(<span class="at">mortgage_pct =</span> with_mortgage <span class="sc">/</span> households)</span>
<span id="cb8-82"><a href="#cb8-82"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: this data isn't really that useful for mn!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="in-class-coding-example-clean_and_join.r-23" class="slide level2">
<h2>In-class coding example: clean_and_join.R (2/3)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co"># join ----------</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># join unified and elementary data by binding rows</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>mortgage_pct_mn <span class="ot">&lt;-</span> mortgage_pct_unified <span class="sc">|&gt;</span> </span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">bind_rows</span>(mortgage_pct_elementary) <span class="sc">|&gt;</span> </span>
<span id="cb9-6"><a href="#cb9-6"></a>  <span class="co"># filter out summary row</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="fu">filter</span>(GEOID <span class="sc">!=</span> <span class="st">"2199999"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-8"><a href="#cb9-8"></a>  <span class="co"># arrange from largest to smallest district</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>  <span class="fu">arrange</span>(<span class="sc">-</span>households)</span>
<span id="cb9-10"><a href="#cb9-10"></a></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co"># join edbuild and census data using left_join</span></span>
<span id="cb9-12"><a href="#cb9-12"></a>edbuild_mortgage_mn <span class="ot">&lt;-</span> edbuild_fy19 <span class="sc">|&gt;</span> </span>
<span id="cb9-13"><a href="#cb9-13"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"Minnesota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="fu">left_join</span>(mortgage_pct_mn, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"NCESID"</span> <span class="ot">=</span> <span class="st">"GEOID"</span>))</span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co"># do the join again, but this time select for the columns we want to keep</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># to avoid duplicates like district.x and district.y</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>edbuild_mortgage_mn <span class="ot">&lt;-</span> edbuild_fy19 <span class="sc">|&gt;</span> </span>
<span id="cb9-19"><a href="#cb9-19"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"Minnesota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-20"><a href="#cb9-20"></a>  <span class="fu">left_join</span>(mortgage_pct_mn <span class="sc">|&gt;</span> </span>
<span id="cb9-21"><a href="#cb9-21"></a>              <span class="fu">select</span>(GEOID, households, with_mortgage, mortgage_pct),</span>
<span id="cb9-22"><a href="#cb9-22"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"NCESID"</span> <span class="ot">=</span> <span class="st">"GEOID"</span>))</span>
<span id="cb9-23"><a href="#cb9-23"></a></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co"># use anti_join() to check for districts with no mortgage data</span></span>
<span id="cb9-25"><a href="#cb9-25"></a>edbuild_mortgage_mn_no_match <span class="ot">&lt;-</span> edbuild_fy19 <span class="sc">|&gt;</span> </span>
<span id="cb9-26"><a href="#cb9-26"></a>  <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"Minnesota"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-27"><a href="#cb9-27"></a>  <span class="fu">anti_join</span>(mortgage_pct_mn <span class="sc">|&gt;</span> </span>
<span id="cb9-28"><a href="#cb9-28"></a>              <span class="fu">select</span>(GEOID,households, with_mortgage, mortgage_pct),</span>
<span id="cb9-29"><a href="#cb9-29"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"NCESID"</span> <span class="ot">=</span> <span class="st">"GEOID"</span>))</span>
<span id="cb9-30"><a href="#cb9-30"></a></span>
<span id="cb9-31"><a href="#cb9-31"></a><span class="co"># run the reverse anti_join to see if the census data has </span></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="co">#  districts not included in the edbuild table</span></span>
<span id="cb9-33"><a href="#cb9-33"></a>mortgage_edbuild_mn_no_match <span class="ot">&lt;-</span> mortgage_pct_mn <span class="sc">|&gt;</span> </span>
<span id="cb9-34"><a href="#cb9-34"></a>  <span class="fu">select</span>(GEOID,households, with_mortgage, mortgage_pct) <span class="sc">|&gt;</span> </span>
<span id="cb9-35"><a href="#cb9-35"></a>  <span class="fu">anti_join</span>(edbuild_fy19 <span class="sc">|&gt;</span> </span>
<span id="cb9-36"><a href="#cb9-36"></a>              <span class="fu">filter</span>(State <span class="sc">==</span> <span class="st">"Minnesota"</span>) ,</span>
<span id="cb9-37"><a href="#cb9-37"></a>            <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"GEOID"</span> <span class="ot">=</span> <span class="st">"NCESID"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="in-class-coding-example-clean_and_join.r-33" class="slide level2">
<h2>In-class coding example: clean_and_join.R (3/3)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># plot -----------</span></span>
<span id="cb10-2"><a href="#cb10-2"></a></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co"># first plot of the joined dataset</span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="fu">ggplot</span>(edbuild_mortgage_mn) <span class="sc">+</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> MHI, <span class="at">y =</span> mortgage_pct, </span>
<span id="cb10-6"><a href="#cb10-6"></a>                 <span class="at">color =</span> StPovRate, <span class="at">size =</span> ENROLL),</span>
<span id="cb10-7"><a href="#cb10-7"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">10</span>, <span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb10-9"><a href="#cb10-9"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb10-10"><a href="#cb10-10"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MHI"</span>, <span class="at">y =</span> <span class="st">"Percent of households with a mortgage"</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>       <span class="at">color =</span> <span class="st">"Poverty rate"</span>, <span class="at">size =</span> <span class="st">"Enrollment"</span>) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-15"><a href="#cb10-15"></a></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co"># facet by sdType</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="fu">ggplot</span>(edbuild_mortgage_mn) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> MHI, <span class="at">y =</span> mortgage_pct, </span>
<span id="cb10-19"><a href="#cb10-19"></a>                 <span class="at">color =</span> StPovRate, <span class="at">size =</span> ENROLL),</span>
<span id="cb10-20"><a href="#cb10-20"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">10</span>, <span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-25"><a href="#cb10-25"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MHI"</span>, <span class="at">y =</span> <span class="st">"Percent of households with a mortgage"</span>,</span>
<span id="cb10-26"><a href="#cb10-26"></a>       <span class="at">color =</span> <span class="st">"Poverty rate"</span>, <span class="at">size =</span> <span class="st">"Enrollment"</span>) <span class="sc">+</span></span>
<span id="cb10-27"><a href="#cb10-27"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sdType) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-29"><a href="#cb10-29"></a></span>
<span id="cb10-30"><a href="#cb10-30"></a><span class="co"># filter out secondary districts and create better labels for </span></span>
<span id="cb10-31"><a href="#cb10-31"></a><span class="co"># elementary and unified districts</span></span>
<span id="cb10-32"><a href="#cb10-32"></a><span class="fu">ggplot</span>(edbuild_mortgage_mn <span class="sc">|&gt;</span> </span>
<span id="cb10-33"><a href="#cb10-33"></a>         <span class="fu">filter</span>(sdType <span class="sc">!=</span> <span class="st">"secon"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-34"><a href="#cb10-34"></a>         <span class="fu">mutate</span>(<span class="at">sdType =</span> <span class="fu">case_when</span>(sdType <span class="sc">==</span> <span class="st">"elem"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb10-35"><a href="#cb10-35"></a>                                   sdType <span class="sc">==</span> <span class="st">"uni"</span> <span class="sc">~</span> <span class="st">"Unified"</span>))) <span class="sc">+</span></span>
<span id="cb10-36"><a href="#cb10-36"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> MHI, <span class="at">y =</span> mortgage_pct, </span>
<span id="cb10-37"><a href="#cb10-37"></a>                 <span class="at">color =</span> StPovRate, <span class="at">size =</span> ENROLL),</span>
<span id="cb10-38"><a href="#cb10-38"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb10-39"><a href="#cb10-39"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">10</span>, <span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb10-40"><a href="#cb10-40"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb10-41"><a href="#cb10-41"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-42"><a href="#cb10-42"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-43"><a href="#cb10-43"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MHI"</span>, <span class="at">y =</span> <span class="st">"Percent of households with a mortgage"</span>,</span>
<span id="cb10-44"><a href="#cb10-44"></a>       <span class="at">color =</span> <span class="st">"Poverty rate"</span>, <span class="at">size =</span> <span class="st">"Enrollment"</span>) <span class="sc">+</span></span>
<span id="cb10-45"><a href="#cb10-45"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sdType) <span class="sc">+</span></span>
<span id="cb10-46"><a href="#cb10-46"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb10-47"><a href="#cb10-47"></a></span>
<span id="cb10-48"><a href="#cb10-48"></a><span class="co"># same chart, but filter  allow for free x+y axis scales</span></span>
<span id="cb10-49"><a href="#cb10-49"></a><span class="fu">ggplot</span>(edbuild_mortgage_mn <span class="sc">|&gt;</span> </span>
<span id="cb10-50"><a href="#cb10-50"></a>         <span class="fu">filter</span>(sdType <span class="sc">!=</span> <span class="st">"secon"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-51"><a href="#cb10-51"></a>         <span class="fu">mutate</span>(<span class="at">sdType =</span> <span class="fu">case_when</span>(sdType <span class="sc">==</span> <span class="st">"elem"</span> <span class="sc">~</span> <span class="st">"Elementary"</span>,</span>
<span id="cb10-52"><a href="#cb10-52"></a>                                   sdType <span class="sc">==</span> <span class="st">"uni"</span> <span class="sc">~</span> <span class="st">"Unified"</span>))) <span class="sc">+</span></span>
<span id="cb10-53"><a href="#cb10-53"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> MHI, <span class="at">y =</span> mortgage_pct, </span>
<span id="cb10-54"><a href="#cb10-54"></a>                 <span class="at">color =</span> StPovRate, <span class="at">size =</span> ENROLL),</span>
<span id="cb10-55"><a href="#cb10-55"></a>             <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span></span>
<span id="cb10-56"><a href="#cb10-56"></a>  <span class="fu">scale_size_area</span>(<span class="at">max_size =</span> <span class="dv">10</span>, <span class="at">labels =</span> <span class="fu">label_comma</span>()) <span class="sc">+</span></span>
<span id="cb10-57"><a href="#cb10-57"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">labels =</span> <span class="fu">label_dollar</span>()) <span class="sc">+</span></span>
<span id="cb10-58"><a href="#cb10-58"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-59"><a href="#cb10-59"></a>  <span class="fu">scale_color_viridis</span>(<span class="at">labels =</span> <span class="fu">label_percent</span>()) <span class="sc">+</span></span>
<span id="cb10-60"><a href="#cb10-60"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"MHI"</span>, <span class="at">y =</span> <span class="st">"Percent of households with a mortgage"</span>,</span>
<span id="cb10-61"><a href="#cb10-61"></a>       <span class="at">color =</span> <span class="st">"Poverty rate"</span>, <span class="at">size =</span> <span class="st">"Enrollment"</span>) <span class="sc">+</span></span>
<span id="cb10-62"><a href="#cb10-62"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>sdType, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb10-63"><a href="#cb10-63"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section>
<section id="homework-assignment" class="title-slide slide level1 center">
<h1>Homework assignment</h1>

</section>
<section id="this-weeks-assignment" class="slide level2 smaller">
<h2>This week’s assignment</h2>
<p><strong>Reading assignment</strong></p>
<ul>
<li><a href="https://bellwether.org/wp-content/uploads/2021/10/Bellwether_SplittingBill_05-HowCanSchoolFinStudentswLearnNeeds_Final.pdf"><strong><em>How Can School Finance Systems Support Students with Additional Learning Needs?</em></strong></a></li>
</ul>
<p><strong>Coding task</strong></p>
<p>Clean your state’s district data and make sure that you have all of the data you need to model your state’s funding formula and the potential policy changes you want to make. This may require joining dataframes, <code>pivot_longer()</code>, <code>pivot_wider()</code> and/or using <code>mutate()</code> to merge, reshape, and tidy data from your state.</p>
<p>Ultimately, you’ll want to produce a single dataframe where:</p>
<ul>
<li>Each row represents a single LEA (traditional district or charter school)</li>
<li>Each column represents a single variable</li>
<li>All of the data elements that go into your current formula are present in the dataframe.</li>
</ul>
<p>If you need to join more than two dataframes, <strong>just start with joining two dataframes for this assingment.</strong> We can work on building the full dataset you’ll need to model your formula over the coming weeks.</p>
<p>To get started, a template R script is included: <code>scripts/dist_clean.R</code> – please use that file to load, clean, and save your tidy data.</p>
<p>As always, once you’ve completed the assignment, be sure to commit and push to GitHub!</p>


<img src="../../images/primary_full-color.png" class="slide-logo r-stretch"><div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>